
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Felipe Lima</title>
  <meta name="author" content="Felipe Lima">

  
  <meta name="description" content="Whoever tried to use SQL Server Express for any medium sized project, has probably experienced some really painful problems accessing the database &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://felipecsl.github.com/blog/page/6/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Felipe Lima" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26310657-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Felipe Lima</a></h1>
  
    <h2>weblog</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:felipecsl.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/06/05/sql-server-express-nightmare/">SQL Server Express Nightmare</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-05T10:19:00-07:00" pubdate data-updated="true">Jun 5<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Whoever tried to use SQL Server Express for any medium sized project, has probably experienced some really painful problems accessing the database file.</p>

<p>Express is a free version of this well known Microsoft database engine which is targeted for smaller business. It has some <a href="http://www.microsoft.com/sqlserver/2005/en/us/compare-features.aspx">limitations</a> when compared to the other enterprise-targeted versions.</p>

<p>One of its key differences is that, unlike the other versions, you don&rsquo;t need a database instance to start working. The only thing you need is an empty MDF file to start off. It can be created from Visual Studio (Add New Item > SQL Server Database) and you&rsquo;re ready to go. However, here is where the problems start&hellip;</p>

<p>The big issue is that the MDF is a regular windows file, like any other. This means that <strong>only one process is able to modify it at a time</strong>.</p>

<p>If you use Visual Studio and/or SQL Server Management Studio regularly, you have probably run into this error when working with SQL Server Express:</p>

<p><img src="/images/2009/6/image.axd.png" alt="" /></p>

<p>There are several reason reasons that could cause this. Here are two that I found most recurring:</p>

<p><strong>Cause 1.</strong> The NETWORK SERVICE user is not able to open the database file because it does not have rights to do so.</p>

<p><strong>Solution 1.</strong> Edit the file permissions and grant Read/Write rights to it: Right mouse click on file or containing folder > Security > Advanced > Edit</p>

<p>If the NETWORK SERVICE is already on the list, make sure it has read/write permission.</p>

<p>Else, click Add&hellip; and type NETWORK SERVICE in the edit field. Add the proper permissions and click Ok in all the open Windows. Reload the webpage.</p>

<p>In some machines, I&rsquo;ve seen the user IIS_IUSRS instead of NETWORK SERVICE, so you can try this one as well. (if it exists)</p>

<p><strong>Cause 2.</strong> Visual Studio is locking the database file. In some cases, when you edit the database inside VS using the Server Explorer window, the handle remais open even after you close the connection with the database.</p>

<p><strong>Solution 2.</strong> If your Visual Studio is open, go to the Server Explorer window and make sure the database connection closed.</p>

<p><img src="/images/2009/6/Sem+t%c3%adtulo.png" alt="" /></p>

<p>If you are using SQL Server Management Studio Express, you have to Detach the database (do not forget to check the checkbox &ldquo;Drop Connections&rdquo; in the subsequent screen):</p>

<p><img src="/images/2009/6/Sem+t%c3%adtulo2.png" alt="" /></p>

<p>Go to your webpage and try reloading it.  It should work now. In case it doesn&rsquo;t work, try closing your Solution inside VS or close the whole VS window. I&rsquo;ve seen cases where VS keeps the database locked even after you closed the connection in the Server Explorer. Unfortunately, the error above isn&rsquo;t related to an open connection and this is why it sometimes it gets really hard to diagnose the issue.</p>

<p>As I said before, only one connection may be open with the SQL Express database file at a time, so always make sure there is no other program with it open. This does not mean that it does not allow concurrent users using the database, but Visual Studio and Management Studio manage to open it in such a way that locks the file entirely. The reason is unknown to me.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/29/more-on-the-entity-framework/">More on the Entity Framework</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-29T04:56:00-07:00" pubdate data-updated="true">May 29<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In my last blog post I wrote a quick introduction on the Entity Framework. I&rsquo;ve been playing with it for the last couple days. I must say I had a bit of a hard time trying to make it work. The good part is that I discovered some nice stuff when searching for solutions.</p>

<p>With Linq, you are able to build a query predicate dinamically with the extension method IQueryable<TSource> Where<TSource>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var queryResults = from p in db.Products;
</span><span class='line'>                   select p;
</span><span class='line'>queryResults = queryResults.Where(p =&gt; p.Price &lt; 1000);</span></code></pre></td></tr></table></div></figure>


<p>But what happens if later your business logic finds out that you need to include in your results products which also cost more than $3000?</p>

<p>No problem! Just call &ldquo;Where&rdquo; again:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(...)
</span><span class='line'>queryResults = queryResults.Where(p =&gt; p.Price &gt; 3000);</span></code></pre></td></tr></table></div></figure>


<p>Right? <strong>NO! </strong>This would result in a query that filters the products for Price &lt; 1000 <strong>AND</strong> Price > 3000. That means, you won&rsquo;t get any results at all! :) What you need, is an <strong>OR</strong> operator between your two Where predicates.</p>

<p>The solution for this is the <a href="http://www.albahari.com/nutshell/linqkit.aspx">LinqKit</a>! It comes with a neat pack of tools for Linq, including a <a href="http://www.albahari.com/nutshell/predicatebuilder.aspx">PredicateBuilder</a> with some extension method that allow you to do something like:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(...)
</span><span class='line'>var queryResults = from p in db.Products;
</span><span class='line'>                   select p;
</span><span class='line'>
</span><span class='line'>var predicate = PredicateBuilder.False&lt;Product&gt;();
</span><span class='line'>predicate = predicate.Or(p =&gt; p.Price &lt; 1000);
</span><span class='line'>predicate = predicate.Or(p =&gt; p.Price &gt; 3000);
</span><span class='line'>queryResults = queryResults.AsExpandable().Where(predicate);  // p.Price &lt; 1000 OR p.Price &gt; 3000</span></code></pre></td></tr></table></div></figure>


<p>You must have noticed the AsExpandable() call above. As per LinqKit documentation:</p>

<p>&ldquo;Entity Framework&rsquo;s query processing pipeline cannot
handle <em>invocation</em> <em>expressions</em>, which is why you need to call <strong>
AsExpandable</strong> on the first object in the query. By calling AsExpandable, you
activate LINQKit&rsquo;s expression visitor class which substitutes invocation
expressions with simpler constructs that Entity Framework can understand.&rdquo;</p>

<p>The Entity Framework has some limitations when compared with Linq to SQL so that some method are not supported. You can check out that is supported and what is not <a href="http://msdn.microsoft.com/en-us/library/bb738550.aspx">here</a>.</p>

<p>If one attempts to use any of these unsupported methods, a runtime exception will be thrown.</p>

<p>PS: Thanks to <a href="http://www.coderesearchcenter.com/post/How-to-format-code-with-blogenginenet.aspx">this blog post</a>, I was able to write nice formatted C# source code in this post.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/20/net-framework-4-and-ado-net-futures/">.Net Framework 4 and ADO.Net Futures</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-20T15:13:00-07:00" pubdate data-updated="true">May 20<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Microsoft has been working on the next version of its .Net Framework 4.0 and the respective IDE: Visual Studio 2010. There is a <a href="http://channel9.msdn.com/shows/10-4/10-4-Episode-20-Downloading-and-Installing-Visual-Studio-2010-Beta-1/">video screencast</a> at Channel9 for downloading and installing the Beta 1.</p>

<p>Some of the new features in this version 4 are: parallel programming support, functional programming with <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/default.aspx">F#</a>, <a href="http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx">code contracts</a>, <a href="http://channel9.msdn.com/shows/10-4/10-4-Episode-16-Windows-Workflow-4/">new WF engine</a>, etc.</p>

<p>One of the biggest improvements I found very useful was the <a href="http://www.asp.net/dynamicdata/">ASP.NET Dynamic Data</a> framework, which was introduced in .Net 3.5 SP1. With this tool, you are able to create an entire data driven website in minutes. It uses Linq to SQL to generate the object/relational data mapping and then builds up pages based on columns data types. There are several built-in Field Templates and Page Templates that are used to build the pages dynamically based on the table schema. Fantastic!</p>

<p>The Dynamic Data Preview 4 can be downloaded from <a href="http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=27026">CodePlex.</a></p>

<p>However, Microsoft also introduced the ADO.Net Entity Framework (or Linq to Entities) in .Net 3.5 SP1 as well, that seems to do the same job that L2S proposes to do. There are some discussions in the web around this. <a href="http://blogs.msdn.com/swiss_dpe_team/archive/2008/11/06/entity-framework-vs-linq-to-sql.aspx">This blog post</a> outlines the main differences between the two technologies. which basically tells us that L2S is more limited that the Entity Framework.</p>

<p>Finally, &ldquo;&hellip; as of .NET 4.0, LINQ to Entities will be the recommended data access solution for LINQ to relational scenarios.&rdquo; (<a href="http://stackoverflow.com/questions/8676/entity-framework-vs-linq-to-sql">source</a>)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/19/my-first-blog-post/">My First Blog Post</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-19T14:00:00-07:00" pubdate data-updated="true">May 19<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve been lately playing with this blog, customizing preparing the floor for this first post. I&rsquo;ve used for this, the <a href="http://www.dotnetblogengine.net/">BlogEngine.NET</a>, which seems to be very powerfull and versatile.</p>

<p>I opted for a simple and clean dark look instead of a heavy fractal background image and transparency on posts, which was pretty cool, but bad for reading. For the title gradient look, I was inspired by a nice post in Tutorial9 website, which has some good web design tips and tutorials. <a href="http://www.tutorial9.net/photoshop/5-pixel-popping-techniques/">Check out</a>.</p>

<p>The intent of this blog is to register and share my findigs on any topic, language and subject that is related to programming and software development in a general way. I&rsquo;ll post my findings as soon as I have something new and useful to post!</p>

<p>My interests are .NET Framework development, specially web-based (ASP.NET) with C#; Javascript, HTML, CSS, Flash Development (ActionScript) and so forth.</p>

<p>So, to officially open this blog, I start with a quick z-axis CSS trick that I found out lately:</p>

<p>In order to be able to specify a z-index to an element in an HTML page, that element must be absolutely positioned (position: absolute), as per <a href="http://www.w3schools.com/Css/pr_pos_z-index.asp">w3-schools.</a> You can achieve this by setting only your inner-most div to position:absolute, since absolute positioned elements are not repositioned when the window is resized, so it would be probably useful to put it inside a centered div in order to not to compromise the whole page appearance.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/5/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/06/publishing-an-android-library-to-maven-central/">Publishing an Android Library to Maven Central with Gradle</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/12/building-a-custom-view-with-android/">Building a Custom View with Android</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/08/20/animated-gifs-with-android/">Handling Animated GIFs with Android the right way</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/31/starting-with-android-managing-images/">Starting with Android - managing images</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/31/when-two-identical-strings-are-different/">When two identical strings are different?</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/felipecsl">@felipecsl</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'felipecsl',
            count: 4,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




<a href="mailto:felipe.lima@gmail.com" title="Pair program with me!">
  <img  src="http://pairprogramwith.me/badge.png"
        alt="Pair program with me!" style="width: 150px" />
</a>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Felipe Lima -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
